<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Module\Member\Util; use ModStart\Core\Dao\ModelUtil; use Module\Vendor\Cache\CacheUtil; class MemberGroupUtil { public static function all() { return CacheUtil::rememberForever('MemberGroupList', function () { return ModelUtil::all('member_group', array(), array('*'), array('id', 'asc')); }); } public static function mapIdTitle() { return array_build(self::all(), function ($Zc0iK, $aEiYS) { return array($aEiYS['id'], $aEiYS['title']); }); } public static function defaultGroup() { foreach (self::all() as $VfQYR) { if ($VfQYR['isDefault']) { return $VfQYR; } } return null; } public static function defaultGroupId() { $VfQYR = self::defaultGroup(); return $VfQYR ? $VfQYR['id'] : 0; } public static function map() { return CacheUtil::rememberForever('MemberGroupMap', function () { return array_build(self::all(), function ($Zc0iK, $aEiYS) { return array($aEiYS['id'], $aEiYS); }); }); } public static function get($NxQml) { goto ugRFg; HjFRz: if (isset($Wseaz[$NxQml])) { return $Wseaz[$NxQml]; } goto e7as8; LOjv1: if (empty($NxQml)) { foreach ($Wseaz as $KdsT8) { if ($KdsT8['isDefault']) { return $KdsT8; } } return null; } goto HjFRz; ugRFg: static $Wseaz = null; goto rzrqr; e7as8: return null; goto BWT3n; rzrqr: if (null === $Wseaz) { $Wseaz = self::map(); } goto LOjv1; BWT3n: } public static function getMemberGroup($qe8fj) { if (empty($qe8fj)) { return self::get(null); } return self::get($qe8fj['groupId']); } public static function clearCache() { CacheUtil::forget('MemberGroupList'); CacheUtil::forget('MemberGroupMap'); } }